# DEPENDENCIES FOR THIS SCRIPT
# - Oh My Posh < https://ohmyposh.dev/docs >
# - Git aliases for pwsh  < https://github.com/gluons/powershell-git-aliases >
# - Starship prompt

Invoke-Expression (&starship init powershell)

# Zsh Git aliases for PowerShell
Import-Module git-aliases -DisableNameChecking

# Tab Override
Set-PSReadlineKeyHandler -Key \ -Function TabCompleteNext 

# vim-like key hacks (similar to my .zshrc)
Set-PSReadlineKeyHandler -Key Tab -Function HistorySearchBackward
Set-PSReadlineKeyHandler -Key Shift+Tab -Function HistorySearchForward
Set-PSReadlineKeyHandler -Key Ctrl+u -Function DeleteLine
Set-PSReadlineKeyHandler -Key Ctrl+w -Function ForwardWord
Set-PSReadlineKeyHandler -Key Ctrl+b -Function BackwardWord

# Always move cursor to end
Set-PSReadLineOption -HistorySearchCursorMovesToEnd 

# List contents on cd
function NavigateAndList
{
    # Get the directory specified by the user
    param([string]$arg)

    # Navigate and List
    Set-Location $arg # Calling cd here would cause an infinite recursion
    ls
}

# List everything, including hidden files
function ForceList
{
    Get-ChildItem -Force
}

# My Aliases
Remove-Item Alias:cd
Set-Alias -Name cd -Value NavigateAndList
Set-Alias -Name vim -Value nvim
Set-Alias -Name touch -Value New-Item
Set-Alias -Name l -Value ForceList
Set-Alias -Name grep -Value "grep -i"

# My Environment Variables
New-Variable -Name hyper -Value "~/Appdata/Roaming/Hyper/"

# List files on startup
cd ~/Dev
